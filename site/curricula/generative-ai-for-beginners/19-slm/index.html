
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="This is Michael Qiu's personal site." name="description"/>
<meta content="Michael Qiu" name="author"/>
<link href="https://gitmichaelqiu.github.io/curricula/generative-ai-for-beginners/19-slm/" rel="canonical"/>
<link href="../18-fine-tuning/" rel="prev"/>
<link href="../20-mistral/" rel="next"/>
<link href="../../../images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.5.34" name="generator"/>
<title>Lesson 19 - Michael Qiu's Blog</title>
<link href="../../../assets/stylesheets/main.35f28582.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#introduction-to-small-language-models-for-generative-ai-for-beginners">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Michael Qiu's Blog" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="Michael Qiu's Blog">
<img alt="logo" src="../../../assets/logo-MK-round-circle-auto.svg"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Michael Qiu's Blog
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Lesson 19
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19.8 5.67A9.8 9.8 0 0 1 22 11h-2.06c-.2-1.43-.78-2.78-1.68-3.9zM13 2.05c1.96.19 3.81.95 5.33 2.21L16.9 5.69A8 8 0 0 0 13 4.05zm-2 .01c-1.96.2-3.81.97-5.33 2.21L7.1 5.69A8 8 0 0 1 11 4.06zM4.26 5.67l1.37 1.39v.04A8 8 0 0 0 4 11H2c.21-1.96 1-3.82 2.26-5.33M2 14v5l1.6-1.6C5.38 20.17 8.47 22 12 22c4.82 0 8.87-3.45 9.8-8h-2.05c-.89 3.45-4.03 6-7.75 6-2.95 0-5.61-1.61-7-4l2-2zm10 3 1.56-3.42L17 12l-3.44-1.56L12 7l-1.57 3.44L7 12l3.43 1.58z"></path></svg>
</label>
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="white" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"></path></svg>
</label>
<input aria-label="Switch to system preference" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to system preference">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/gitmichaelqiu/gitmichaelqiu.github.io" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    gitmichaelqiu.github.io
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../..">
          
  
  Home

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../algorithms/gcd-lcm/">
          
  
  Algorithms

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../data-structures/binary-heap/">
          
  
  Data Structures

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../oi-tips/elapsed-time/">
          
  
  OI Tips

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../academic-notes/calculus/limit/">
          
  
  Academic Notes

        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../../ai-for-beginners/">
          
  
  Curricula

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../blog/">
          
  
  Blog

        </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Michael Qiu's Blog" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="Michael Qiu's Blog">
<img alt="logo" src="../../../assets/logo-MK-round-circle-auto.svg"/>
</a>
    Michael Qiu's Blog
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/gitmichaelqiu/gitmichaelqiu.github.io" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    gitmichaelqiu.github.io
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
<span class="md-ellipsis">
    Home
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
            Home
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../..">
<span class="md-ellipsis">
    About
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../my-projects/my-projects/">
<span class="md-ellipsis">
    My Projects
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../some-websites/">
<span class="md-ellipsis">
    Some Websites
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-ellipsis">
    Algorithms
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Algorithms
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../algorithms/gcd-lcm/">
<span class="md-ellipsis">
    GCD &amp; LCM
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
<span class="md-ellipsis">
    Prime
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_2">
<span class="md-nav__icon md-icon"></span>
            Prime
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../algorithms/prime/euler-sieve/">
<span class="md-ellipsis">
    Euler Sieve
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
<span class="md-ellipsis">
    Search
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_3">
<span class="md-nav__icon md-icon"></span>
            Search
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../algorithms/search/a-star/">
<span class="md-ellipsis">
    A*
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
<span class="md-ellipsis">
    Shortest Path
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_4">
<span class="md-nav__icon md-icon"></span>
            Shortest Path
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../algorithms/shortest-path/bellman-ford/">
<span class="md-ellipsis">
    Bellman Ford
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../algorithms/shortest-path/dijkstra/">
<span class="md-ellipsis">
    Dijkstra (prioirty_queue)
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../algorithms/shortest-path/floyd/">
<span class="md-ellipsis">
    Floyd
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../algorithms/shortest-path/spfa/">
<span class="md-ellipsis">
    SPFA
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
<span class="md-ellipsis">
    Sort
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_5_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_5">
<span class="md-nav__icon md-icon"></span>
            Sort
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../algorithms/sort/sort-overview/">
<span class="md-ellipsis">
    Sort Overview
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../algorithms/quick-pow/">
<span class="md-ellipsis">
    Quick Pow
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-ellipsis">
    Data Structures
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            Data Structures
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../data-structures/binary-heap/">
<span class="md-ellipsis">
    Binary Heap
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../data-structures/disjoint-set-union/">
<span class="md-ellipsis">
    Disjoint Set Union
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../data-structures/segment-tree/">
<span class="md-ellipsis">
    Segment Tree
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../data-structures/sparse-table/">
<span class="md-ellipsis">
    Sparse Table
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../data-structures/stack/">
<span class="md-ellipsis">
    Stack
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
<span class="md-ellipsis">
    Tree
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_6_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_6">
<span class="md-nav__icon md-icon"></span>
            Tree
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../data-structures/tree/binary-tree-traversals/">
<span class="md-ellipsis">
    Binary Tree Traversals
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    OI Tips
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            OI Tips
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../oi-tips/elapsed-time/">
<span class="md-ellipsis">
    Elapsed Time Measurement
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../oi-tips/file-read-and-write/">
<span class="md-ellipsis">
    File Read &amp; Write
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../oi-tips/gcc-optimize/">
<span class="md-ellipsis">
    GCC Optimize
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../oi-tips/accelerate-ios/">
<span class="md-ellipsis">
    iostream Acceleration
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../oi-tips/qread-and-qwrite/">
<span class="md-ellipsis">
    Quick Read &amp; Write
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
<span class="md-ellipsis">
    Academic Notes
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            Academic Notes
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
<span class="md-ellipsis">
    Calculus
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_1">
<span class="md-nav__icon md-icon"></span>
            Calculus
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../academic-notes/calculus/limit/">
<span class="md-ellipsis">
    Limit
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../academic-notes/calculus/differentiation/">
<span class="md-ellipsis">
    Differentiation
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../academic-notes/calculus/fundamental-calculus/">
<span class="md-ellipsis">
    Fundamental Calculus
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
<span class="md-ellipsis">
    Chinese
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_2">
<span class="md-nav__icon md-icon"></span>
            Chinese
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_2_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_2_1" id="__nav_5_2_1_label" tabindex="0">
<span class="md-ellipsis">
    初中
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_2_1_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_5_2_1">
<span class="md-nav__icon md-icon"></span>
            初中
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../academic-notes/chinese/junior-notes/geography/">
<span class="md-ellipsis">
    初中地理总结
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_2_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_2_2" id="__nav_5_2_2_label" tabindex="0">
<span class="md-ellipsis">
    高中
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_2_2_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_5_2_2">
<span class="md-nav__icon md-icon"></span>
            高中
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../academic-notes/chinese/senior-high-school/sets/">
<span class="md-ellipsis">
    集合
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
<span class="md-ellipsis">
    Curricula
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
            Curricula
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
<span class="md-ellipsis">
    AI For Beginners
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_6_1">
<span class="md-nav__icon md-icon"></span>
            AI For Beginners
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../ai-for-beginners/">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ai-for-beginners/1-Intro/">
<span class="md-ellipsis">
    Lesson 1
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ai-for-beginners/2-Symbolic/">
<span class="md-ellipsis">
    Lesson 2
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6_1_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_1_4" id="__nav_6_1_4_label" tabindex="0">
<span class="md-ellipsis">
    Lesson 3
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_1_4_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_6_1_4">
<span class="md-nav__icon md-icon"></span>
            Lesson 3
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../ai-for-beginners/3-NeuralNetworks/">
<span class="md-ellipsis">
    Intro
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ai-for-beginners/3-NeuralNetworks/03-Perceptron/">
<span class="md-ellipsis">
    Perceptron
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ai-for-beginners/3-NeuralNetworks/04-OwnFramework/">
<span class="md-ellipsis">
    Own Framework
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ai-for-beginners/3-NeuralNetworks/05-Frameworks/">
<span class="md-ellipsis">
    Frameworks
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ai-for-beginners/4-ComputerVision/">
<span class="md-ellipsis">
    Lesson 4
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ai-for-beginners/5-NLP/">
<span class="md-ellipsis">
    Lesson 5
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6_1_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_1_7" id="__nav_6_1_7_label" tabindex="0">
<span class="md-ellipsis">
    Lesson 6
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_1_7_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_6_1_7">
<span class="md-nav__icon md-icon"></span>
            Lesson 6
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../ai-for-beginners/6-Other/21-GeneticAlgorithms/">
<span class="md-ellipsis">
    Genetic Algorithms
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ai-for-beginners/6-Other/22-DeepRL/">
<span class="md-ellipsis">
    Deep RL
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ai-for-beginners/6-Other/23-MultiagentSystems/">
<span class="md-ellipsis">
    Multi-Agent Systems
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ai-for-beginners/7-Ethics/">
<span class="md-ellipsis">
    Lesson 7
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ai-for-beginners/X-Extras/X1-MultiModal/">
<span class="md-ellipsis">
    Lesson X
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_6_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
<span class="md-ellipsis">
    Generative AI for Beginners
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_6_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_6_2">
<span class="md-nav__icon md-icon"></span>
            Generative AI for Beginners
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../01-introduction-to-genai/">
<span class="md-ellipsis">
    Lesson 1
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../02-exploring-and-comparing-different-llms/">
<span class="md-ellipsis">
    Lesson 2
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../03-using-generative-ai-responsibly/">
<span class="md-ellipsis">
    Lesson 3
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../04-prompt-engineering-fundamentals/">
<span class="md-ellipsis">
    Lesson 4
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../05-advanced-prompts/">
<span class="md-ellipsis">
    Lesson 5
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../06-text-generation-apps/">
<span class="md-ellipsis">
    Lesson 6
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../07-building-chat-applications/">
<span class="md-ellipsis">
    Lesson 7
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../08-building-search-applications/">
<span class="md-ellipsis">
    Lesson 8
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../09-building-image-applications/">
<span class="md-ellipsis">
    Lesson 9
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../10-building-low-code-ai-applications/">
<span class="md-ellipsis">
    Lesson 10
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../11-integrating-with-function-calling/">
<span class="md-ellipsis">
    Lesson 11
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../12-designing-ux-for-ai-applications/">
<span class="md-ellipsis">
    Lesson 12
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../13-securing-ai-applications/">
<span class="md-ellipsis">
    Lesson 13
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../14-the-generative-ai-application-lifecycle/">
<span class="md-ellipsis">
    Lesson 14
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../15-rag-and-vector-databases/">
<span class="md-ellipsis">
    Lesson 15
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../16-open-source-models/">
<span class="md-ellipsis">
    Lesson 16
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../17-ai-agents/">
<span class="md-ellipsis">
    Lesson 17
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../18-fine-tuning/">
<span class="md-ellipsis">
    Lesson 18
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Lesson 19
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Lesson 19
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#introduction-to-small-language-models-for-generative-ai-for-beginners">
<span class="md-ellipsis">
      Introduction to Small Language Models for Generative AI for Beginners
    </span>
</a>
<nav aria-label="Introduction to Small Language Models for Generative AI for Beginners" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#what-are-small-language-models">
<span class="md-ellipsis">
      What Are Small Language Models?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-do-small-language-models-work">
<span class="md-ellipsis">
      How Do Small Language Models Work?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#learning-objectives">
<span class="md-ellipsis">
      Learning Objectives
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#the-distinctions-between-large-language-models-llms-and-small-language-models-slms">
<span class="md-ellipsis">
      The Distinctions between Large Language Models (LLMs) and Small Language Models (SLMs)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#applications-of-small-language-models">
<span class="md-ellipsis">
      Applications of Small Language Models
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#introduce-phi-3-phi-35-family">
<span class="md-ellipsis">
      Introduce Phi-3 / Phi-3.5 Family
    </span>
</a>
<nav aria-label="Introduce Phi-3 / Phi-3.5 Family" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#phi-3-35-instruct">
<span class="md-ellipsis">
      Phi-3 / 3.5 Instruct
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#phi-3-35-vision">
<span class="md-ellipsis">
      Phi-3 / 3.5 Vision
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#phi-35-moe">
<span class="md-ellipsis">
      Phi-3.5-MoE
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-to-use-phi-335-family-models">
<span class="md-ellipsis">
      How to use Phi-3/3.5 Family models
    </span>
</a>
<nav aria-label="How to use Phi-3/3.5 Family models" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#inference-difference-clouds-api">
<span class="md-ellipsis">
      Inference difference Cloud's API
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#inference-phi-335-in-local-env">
<span class="md-ellipsis">
      Inference Phi-3/3.5 in local env
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#what-is-onnx-runtime">
<span class="md-ellipsis">
      What is ONNX Runtime?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#what-is-generative-ai">
<span class="md-ellipsis">
      What is Generative AI?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#onnx-runtime-for-genai">
<span class="md-ellipsis">
      ONNX Runtime for GENAI
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#getting-started">
<span class="md-ellipsis">
      Getting Started
    </span>
</a>
<nav aria-label="Getting Started" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#install-onnx-runtime">
<span class="md-ellipsis">
      Install ONNX Runtime:
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#install-the-generative-ai-extensions">
<span class="md-ellipsis">
      Install the Generative AI Extensions:
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#run-a-model-heres-a-simple-example-in-python">
<span class="md-ellipsis">
      Run a Model: Here’s a simple example in Python:
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#demousing-onnx-runtime-genai-to-call-phi-35-vision">
<span class="md-ellipsis">
      Demo:Using ONNX Runtime GenAI to call Phi-3.5-Vision
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#more">
<span class="md-ellipsis">
      More
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../20-mistral/">
<span class="md-ellipsis">
    Lesson 20
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../21-meta/">
<span class="md-ellipsis">
    Lesson 21
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_3" id="__nav_6_3_label" tabindex="0">
<span class="md-ellipsis">
    ML for Beginners
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_6_3">
<span class="md-nav__icon md-icon"></span>
            ML for Beginners
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6_3_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_3_2" id="__nav_6_3_2_label" tabindex="0">
<span class="md-ellipsis">
    Lesson 1
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_3_2_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_6_3_2">
<span class="md-nav__icon md-icon"></span>
            Lesson 1
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/1-Introduction/">
<span class="md-ellipsis">
    Introduction
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/1-Introduction/1-intro-to-ML/">
<span class="md-ellipsis">
    Intro to ML
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/1-Introduction/2-history-of-ML/">
<span class="md-ellipsis">
    History of ML
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/1-Introduction/3-fairness/">
<span class="md-ellipsis">
    Fairness
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/1-Introduction/4-techniques-of-ML/">
<span class="md-ellipsis">
    Techniques of ML
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6_3_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_3_3" id="__nav_6_3_3_label" tabindex="0">
<span class="md-ellipsis">
    Lesson 2
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_3_3_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_6_3_3">
<span class="md-nav__icon md-icon"></span>
            Lesson 2
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/2-Regression/">
<span class="md-ellipsis">
    Regression
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/2-Regression/1-Tools/">
<span class="md-ellipsis">
    Tools
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/2-Regression/2-Data/">
<span class="md-ellipsis">
    Data
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/2-Regression/3-Linear/">
<span class="md-ellipsis">
    Linear
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/2-Regression/4-Logistic/">
<span class="md-ellipsis">
    Logistic
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/3-Web-App/">
<span class="md-ellipsis">
    Lesson 3
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6_3_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_3_5" id="__nav_6_3_5_label" tabindex="0">
<span class="md-ellipsis">
    Lesson 4
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_3_5_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_6_3_5">
<span class="md-nav__icon md-icon"></span>
            Lesson 4
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/4-Classification/">
<span class="md-ellipsis">
    Classification
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/4-Classification/1-Introduction/">
<span class="md-ellipsis">
    Introduction
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/4-Classification/2-Classifiers-1/">
<span class="md-ellipsis">
    Classifiers 1
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/4-Classification/3-Classifiers-2/">
<span class="md-ellipsis">
    Classifiers 2
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/4-Classification/4-Applied/">
<span class="md-ellipsis">
    Applied
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6_3_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_3_6" id="__nav_6_3_6_label" tabindex="0">
<span class="md-ellipsis">
    Lesson 5
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_3_6_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_6_3_6">
<span class="md-nav__icon md-icon"></span>
            Lesson 5
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/5-Clustering/">
<span class="md-ellipsis">
    Clustering
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/5-Clustering/1-Visualize/">
<span class="md-ellipsis">
    Visualize
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/5-Clustering/2-K-Means/">
<span class="md-ellipsis">
    K Means
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6_3_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_3_7" id="__nav_6_3_7_label" tabindex="0">
<span class="md-ellipsis">
    Lesson 6
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_3_7_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_6_3_7">
<span class="md-nav__icon md-icon"></span>
            Lesson 6
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/6-NLP/">
<span class="md-ellipsis">
    NLP
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/6-NLP/1-Introduction-to-NLP/">
<span class="md-ellipsis">
    Introduction to NLP
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/6-NLP/2-Tasks/">
<span class="md-ellipsis">
    Tasks
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/6-NLP/3-Translation-Sentiment/">
<span class="md-ellipsis">
    Translation Sentiment
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/6-NLP/4-Hotel-Reviews-1/">
<span class="md-ellipsis">
    Hotel Reviews 1
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/6-NLP/5-Hotel-Reviews-2/">
<span class="md-ellipsis">
    Hotel Reviews 2
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6_3_8" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_3_8" id="__nav_6_3_8_label" tabindex="0">
<span class="md-ellipsis">
    Lesson 7
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_3_8_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_6_3_8">
<span class="md-nav__icon md-icon"></span>
            Lesson 7
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/7-TimeSeries/">
<span class="md-ellipsis">
    Time Series
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/7-TimeSeries/1-Introduction/">
<span class="md-ellipsis">
    Introduction
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/7-TimeSeries/2-ARIMA/">
<span class="md-ellipsis">
    ARIMA
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/7-TimeSeries/3-SVR/">
<span class="md-ellipsis">
    SVR
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6_3_9" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_3_9" id="__nav_6_3_9_label" tabindex="0">
<span class="md-ellipsis">
    Lesson 8
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_3_9_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_6_3_9">
<span class="md-nav__icon md-icon"></span>
            Lesson 8
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/8-Reinforcement/">
<span class="md-ellipsis">
    Reinforcement
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/8-Reinforcement/1-QLearning/">
<span class="md-ellipsis">
    Q-Learning
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/8-Reinforcement/2-Gym/">
<span class="md-ellipsis">
    Gym
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6_3_10" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_3_10" id="__nav_6_3_10_label" tabindex="0">
<span class="md-ellipsis">
    Lesson 9
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_3_10_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_6_3_10">
<span class="md-nav__icon md-icon"></span>
            Lesson 9
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/9-Real-World/">
<span class="md-ellipsis">
    Real World
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/9-Real-World/1-Applications/">
<span class="md-ellipsis">
    Applications
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ml-for-beginners/9-Real-World/2-Debugging-ML-Models/">
<span class="md-ellipsis">
    Debugging ML Models
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
<span class="md-ellipsis">
    Blog
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_7">
<span class="md-nav__icon md-icon"></span>
            Blog
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../blog/">
<span class="md-ellipsis">
    Index
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_7_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
<span class="md-ellipsis">
    Archive
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_7_2">
<span class="md-nav__icon md-icon"></span>
            Archive
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../blog/archive/2024/">
<span class="md-ellipsis">
    2024
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_7_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
<span class="md-ellipsis">
    Categories
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_7_3">
<span class="md-nav__icon md-icon"></span>
            Categories
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../blog/category/ai/">
<span class="md-ellipsis">
    Ai
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#introduction-to-small-language-models-for-generative-ai-for-beginners">
<span class="md-ellipsis">
      Introduction to Small Language Models for Generative AI for Beginners
    </span>
</a>
<nav aria-label="Introduction to Small Language Models for Generative AI for Beginners" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#what-are-small-language-models">
<span class="md-ellipsis">
      What Are Small Language Models?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-do-small-language-models-work">
<span class="md-ellipsis">
      How Do Small Language Models Work?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#learning-objectives">
<span class="md-ellipsis">
      Learning Objectives
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#the-distinctions-between-large-language-models-llms-and-small-language-models-slms">
<span class="md-ellipsis">
      The Distinctions between Large Language Models (LLMs) and Small Language Models (SLMs)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#applications-of-small-language-models">
<span class="md-ellipsis">
      Applications of Small Language Models
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#introduce-phi-3-phi-35-family">
<span class="md-ellipsis">
      Introduce Phi-3 / Phi-3.5 Family
    </span>
</a>
<nav aria-label="Introduce Phi-3 / Phi-3.5 Family" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#phi-3-35-instruct">
<span class="md-ellipsis">
      Phi-3 / 3.5 Instruct
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#phi-3-35-vision">
<span class="md-ellipsis">
      Phi-3 / 3.5 Vision
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#phi-35-moe">
<span class="md-ellipsis">
      Phi-3.5-MoE
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-to-use-phi-335-family-models">
<span class="md-ellipsis">
      How to use Phi-3/3.5 Family models
    </span>
</a>
<nav aria-label="How to use Phi-3/3.5 Family models" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#inference-difference-clouds-api">
<span class="md-ellipsis">
      Inference difference Cloud's API
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#inference-phi-335-in-local-env">
<span class="md-ellipsis">
      Inference Phi-3/3.5 in local env
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#what-is-onnx-runtime">
<span class="md-ellipsis">
      What is ONNX Runtime?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#what-is-generative-ai">
<span class="md-ellipsis">
      What is Generative AI?
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#onnx-runtime-for-genai">
<span class="md-ellipsis">
      ONNX Runtime for GENAI
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#getting-started">
<span class="md-ellipsis">
      Getting Started
    </span>
</a>
<nav aria-label="Getting Started" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#install-onnx-runtime">
<span class="md-ellipsis">
      Install ONNX Runtime:
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#install-the-generative-ai-extensions">
<span class="md-ellipsis">
      Install the Generative AI Extensions:
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#run-a-model-heres-a-simple-example-in-python">
<span class="md-ellipsis">
      Run a Model: Here’s a simple example in Python:
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#demousing-onnx-runtime-genai-to-call-phi-35-vision">
<span class="md-ellipsis">
      Demo:Using ONNX Runtime GenAI to call Phi-3.5-Vision
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#more">
<span class="md-ellipsis">
      More
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1>Lesson 19</h1>
<div><h2 id="introduction-to-small-language-models-for-generative-ai-for-beginners">Introduction to Small Language Models for Generative AI for Beginners<a class="headerlink" href="#introduction-to-small-language-models-for-generative-ai-for-beginners" title="Permanent link">¶</a></h2>
<p>Generative AI is a fascinating field of artificial intelligence that focuses on creating systems capable of generating new content. This content can range from text and images to music and even entire virtual environments. One of the most exciting applications of generative AI is in the realm of language models.</p>
<h3 id="what-are-small-language-models">What Are Small Language Models?<a class="headerlink" href="#what-are-small-language-models" title="Permanent link">¶</a></h3>
<p>A Small Language Model (SLM) represents a scaled-down variant of a large language model (LLM), leveraging many of the architectural principles and techniques of LLMs, while exhibiting a significantly reduced computational footprint. </p>
<p>SLMs are a subset of language models designed to generate human-like text. Unlike their larger counterparts, such as GPT-4, SLMs are more compact and efficient, making them ideal for applications where computational resources are limited. Despite their smaller size, they can still perform a variety of tasks. Typically, SLMs are constructed by compressing or distilling LLMs, aiming to retain a substantial portion of the original model's functionality and linguistic capabilities. This reduction in model size decreases the overall complexity, making SLMs more efficient in terms of both memory usage and computational requirements. Despite these optimizations, SLMs can still perform a wide range of natural language processing (NLP) tasks:</p>
<ul>
<li>Text Generation: Creating coherent and contextually relevant sentences or paragraphs.</li>
<li>Text Completion: Predicting and completing sentences based on a given prompt.</li>
<li>Translation: Converting text from one language to another.</li>
<li>Summarization: Condensing long pieces of text into shorter, more digestible summaries.</li>
</ul>
<p>Albeit with some trade-offs in performance or depth of understanding compared to their larger counterparts. </p>
<h3 id="how-do-small-language-models-work">How Do Small Language Models Work?<a class="headerlink" href="#how-do-small-language-models-work" title="Permanent link">¶</a></h3>
<p>SLMs are trained on vast amounts of text data. During training, they learn the patterns and structures of language, enabling them to generate text that is both grammatically correct and contextually appropriate. The training process involves:</p>
<ul>
<li>Data Collection: Gathering large datasets of text from various sources.</li>
<li>Preprocessing: Cleaning and organizing the data to make it suitable for training.</li>
<li>Training: Using machine learning algorithms to teach the model how to understand and generate text.</li>
<li>Fine-Tuning: Adjusting the model to improve its performance on specific tasks.</li>
</ul>
<p>The development of SLMs aligns with the increasing need for models that can be deployed in resource-constrained environments, such as mobile devices or edge computing platforms, where full-scale LLMs may be impractical due to their heavy resource demands. By focusing on efficiency, SLMs balance performance with accessibility, enabling broader application across various domains.</p>
<p><img alt="slm" src="img/slm.png?WT.mc_id=academic-105485-koreyst"/></p>
<h3 id="learning-objectives">Learning Objectives<a class="headerlink" href="#learning-objectives" title="Permanent link">¶</a></h3>
<p>In this lesson, we hope to introduce the knowledge of SLM and combine it with Microsoft Phi-3 to learn different scenarios in text content, vision and MoE.</p>
<p>By the end of this lesson, you should be able to answer the following questions:</p>
<ul>
<li>What is SLM</li>
<li>What is the difference about SLM and LLM</li>
<li>What is Microsoft Phi-3/3.5 Family</li>
<li>How to inference Microsoft Phi-3/3.5 Family</li>
</ul>
<p>Ready? Let's get started.</p>
<h3 id="the-distinctions-between-large-language-models-llms-and-small-language-models-slms">The Distinctions between Large Language Models (LLMs) and Small Language Models (SLMs)<a class="headerlink" href="#the-distinctions-between-large-language-models-llms-and-small-language-models-slms" title="Permanent link">¶</a></h3>
<p>Both LLMs and SLMs are built upon foundational principles of probabilistic machine learning, following similar approaches in their architectural design, training methodologies, data generation processes, and model evaluation techniques. However, several key factors differentiate these two types of models.</p>
<h3 id="applications-of-small-language-models">Applications of Small Language Models<a class="headerlink" href="#applications-of-small-language-models" title="Permanent link">¶</a></h3>
<p>SLMs have a wide range of applications, including:</p>
<ul>
<li>Chatbots: Providing customer support and engaging with users in a conversational manner.</li>
<li>Content Creation: Assisting writers by generating ideas or even drafting entire articles.</li>
<li>Education: Helping students with writing assignments or learning new languages.</li>
<li>Accessibility: Creating tools for individuals with disabilities, such as text-to-speech systems.</li>
</ul>
<p><strong>Size</strong></p>
<p>A primary distinction between LLMs and SLMs lies in the scale of the models. LLMs, such as ChatGPT (GPT-4), can comprise an estimated 1.76 trillion parameters, while open-source SLMs like Mistral 7B are designed with significantly fewer parameters—approximately 7 billion. This disparity is primarily due to differences in model architecture and training processes. For instance, ChatGPT employs a self-attention mechanism within an encoder-decoder framework, whereas Mistral 7B uses sliding window attention, which enables more efficient training within a decoder-only model. This architectural variance has profound implications for the complexity and performance of these models.</p>
<p><strong>Comprehension</strong></p>
<p>SLMs are typically optimized for performance within specific domains, making them highly specialized but potentially limited in their ability to provide broad contextual understanding across multiple fields of knowledge. In contrast, LLMs aim to simulate human-like intelligence on a more comprehensive level. Trained on vast, diverse datasets, LLMs are designed to perform well across a variety of domains, offering greater versatility and adaptability. Consequently, LLMs are more suitable for a wider range of downstream tasks, such as natural language processing and programming.</p>
<p><strong>Computing</strong></p>
<p>The training and deployment of LLMs are resource-intensive processes, often requiring significant computational infrastructure, including large-scale GPU clusters. For example, training a model like ChatGPT from scratch may necessitate thousands of GPUs over extended periods. In contrast, SLMs, with their smaller parameter counts, are more accessible in terms of computational resources. Models like Mistral 7B can be trained and run on local machines equipped with moderate GPU capabilities, although training still demands several hours across multiple GPUs.</p>
<p><strong>Bias</strong></p>
<p>Bias is a known issue in LLMs, primarily due to the nature of the training data. These models often rely on raw, openly available data from the internet, which may underrepresent or misrepresent certain groups, introduce erroneous labeling, or reflect linguistic biases influenced by dialect, geographic variations, and grammatical rules. Additionally, the complexity of LLM architectures can inadvertently exacerbate bias, which may go unnoticed without careful fine-tuning. On the other hand, SLMs, being trained on more constrained, domain-specific datasets, are inherently less susceptible to such biases, though they are not immune to them.</p>
<p><strong>Inference</strong></p>
<p>The reduced size of SLMs affords them a significant advantage in terms of inference speed, allowing them to generate outputs efficiently on local hardware without the need for extensive parallel processing. In contrast, LLMs, due to their size and complexity, often require substantial parallel computational resources to achieve acceptable inference times. The presence of multiple concurrent users further slows down LLMs' response times, especially when deployed at scale.</p>
<p>In summary, while both LLMs and SLMs share a foundational basis in machine learning, they differ significantly in terms of model size, resource requirements, contextual understanding, susceptibility to bias, and inference speed. These distinctions reflect their respective suitability for different use cases, with LLMs being more versatile but resource-heavy, and SLMs offering more domain-specific efficiency with reduced computational demands.</p>
<p><strong><em>Note：In this chapter, we will introduce SLM using Microsoft Phi-3 / 3.5 as an example.</em></strong></p>
<h3 id="introduce-phi-3-phi-35-family">Introduce Phi-3 / Phi-3.5 Family<a class="headerlink" href="#introduce-phi-3-phi-35-family" title="Permanent link">¶</a></h3>
<p>Phi-3 / 3.5 Family mainly targets text, vision, and Agent (MoE) application scenarios:</p>
<h4 id="phi-3-35-instruct">Phi-3 / 3.5 Instruct<a class="headerlink" href="#phi-3-35-instruct" title="Permanent link">¶</a></h4>
<p>Mainly for text generation, chat completion, and content information extraction, etc.</p>
<p><strong>Phi-3-mini</strong></p>
<p>The 3.8B language model is available on Microsoft Azure AI Studio, Hugging Face, and Ollama. Phi-3 models significantly outperform language models of equal and larger sizes on key benchmarks (see benchmark numbers below, higher numbers are better). Phi-3-mini outperforms models twice its size, while Phi-3-small and Phi-3-medium outperform larger models, including GPT-3.5</p>
<p><strong>Phi-3-small &amp; medium</strong></p>
<p>With just 7B parameters, Phi-3-small beats GPT-3.5T on a variety of language, reasoning, coding, and math benchmarks.</p>
<p>The Phi-3-medium with 14B parameters continues this trend and outperforms the Gemini 1.0 Pro.</p>
<p><strong>Phi-3.5-mini</strong></p>
<p>We can think of it as an upgrade of Phi-3-mini. While the parameters remain unchanged, it improves the ability to support multiple languages(
Support 20+ languages:Arabic, Chinese, Czech, Danish, Dutch, English, Finnish, French, German, Hebrew, Hungarian, Italian, Japanese, Korean, Norwegian, Polish, Portuguese, Russian, Spanish, Swedish, Thai, Turkish, Ukrainian) ​​and adds stronger support for long context.</p>
<p>Phi-3.5-mini with 3.8B parameters outperforms language models of the same size and on par with models twice its size.</p>
<h4 id="phi-3-35-vision">Phi-3 / 3.5 Vision<a class="headerlink" href="#phi-3-35-vision" title="Permanent link">¶</a></h4>
<p>We can think of the Instruct model of Phi-3/3.5 as Phi's ability to understand, and Vision is what gives Phi eyes to understand the world.</p>
<p><strong>Phi-3-Vision</strong></p>
<p>Phi-3-vision, with only 4.2B parameters, continues this trend and outperforms larger models such as Claude-3 Haiku and Gemini 1.0 Pro V on general visual reasoning tasks, OCR, and table and diagram comprehension tasks.</p>
<p><strong>Phi-3.5-Vision</strong></p>
<p>Phi-3.5-Vision is also an upgrade of Phi-3-Vision, adding support for multiple images. You can think of it as an improvement in vision, not only can you see pictures, but also videos.</p>
<p>Phi-3.5-vision outperforms larger models such as Claude-3.5 Sonnet and Gemini 1.5 Flash across OCR, table and chart understanding tasks and on par on general visual knowledge reasoning tasks.Support multi-frame input, i.e., perform reasoning on multiple input images</p>
<h4 id="phi-35-moe">Phi-3.5-MoE<a class="headerlink" href="#phi-35-moe" title="Permanent link">¶</a></h4>
<p><strong><em>Mixture of Experts(MoE)</em></strong> enable models to be pretrained with far less compute, which means you can dramatically scale up the model or dataset size with the same compute budget as a dense model. In particular, a MoE model should achieve the same quality as its dense counterpart much faster during pretraining.</p>
<p>Phi-3.5-MoE comprises 16x3.8B expert modules.Phi-3.5-MoE with only 6.6B active parameters achieves a similar level of reasoning, language understanding, and math as much larger models</p>
<p>We can use the Phi-3/3.5 Family model based on different scenarios. Unlike LLM, you can deploy Phi-3/3.5-mini or Phi-3/3.5-Vision on edge devices.</p>
<h3 id="how-to-use-phi-335-family-models">How to use Phi-3/3.5 Family models<a class="headerlink" href="#how-to-use-phi-335-family-models" title="Permanent link">¶</a></h3>
<p>We hope to use Phi-3/3.5 in different scenarios. Next, we will use Phi-3/3.5 based on different scenarios.</p>
<p><img alt="phi3" src="img/phi3.png?WT.mc_id=academic-105485-koreyst"/></p>
<h4 id="inference-difference-clouds-api">Inference difference Cloud's API<a class="headerlink" href="#inference-difference-clouds-api" title="Permanent link">¶</a></h4>
<p><strong>GitHub Models</strong></p>
<p>GitHub Models is the most direct way. You can quickly access the Phi-3/3.5-Instruct model through GitHub Models. Combined with the Azure AI Inference SDK / OpenAI SDK, you can access the API through code to complete the Phi-3/3.5-Instruct call. You can also test different effects through Playground.</p>
<ul>
<li>Demo:Comparison of the effects of Phi-3-mini and Phi-3.5-mini in Chinese scenarios</li>
</ul>
<p><img alt="phi3" src="img/gh1.png?WT.mc_id=academic-105485-koreyst"/></p>
<p><img alt="phi35" src="img/gh2.png?WT.mc_id=academic-105485-koreyst"/></p>
<p><strong>Azure AI Studio</strong></p>
<p>Or if we want to use the vision and MoE models, you can use Azure AI Studio to complete the call. If you are interested, you can read the Phi-3 Cookbook to learn how to call Phi-3/3.5 Instruct, Vision, MoE through Azure AI Studio <a href="https://github.com/microsoft/Phi-3CookBook/blob/main/md/02.QuickStart/AzureAIStudio_QuickStart.md?WT.mc_id=academic-105485-koreyst">Click this link</a></p>
<p><strong>NVIDIA NIM</strong></p>
<p>In addition to the cloud-based Model Catalog solutions provided by Azure and GitHub, you can also use <a href="https://developer.nvidia.com/nim?WT.mc_id=academic-105485-koreyst">Nivida NIM</a> to complete related calls. You can visit NIVIDA NIM to complete the API calls of Phi-3/3.5 Family. NVIDIA NIM (NVIDIA Inference Microservices) is a set of accelerated inference microservices designed to help developers deploy AI models efficiently across various environments, including clouds, data centers, and workstations.</p>
<p>Here are some key features of NVIDIA NIM:</p>
<ul>
<li><strong>Ease of Deployment:</strong> NIM allows for the deployment of AI models with a single command, making it straightforward to integrate into existing workflows.</li>
<li><strong>Optimized Performance:</strong> It leverages NVIDIA’s pre-optimized inference engines, such as TensorRT and TensorRT-LLM, to ensure low latency and high throughput.</li>
<li><strong>Scalability:</strong> NIM supports autoscaling on Kubernetes, enabling it to handle varying workloads effectively.</li>
<li><strong>Security and Control:</strong> Organizations can maintain control over their data and applications by self-hosting NIM microservices on their own managed infrastructure.</li>
<li><strong>Standard APIs:</strong> NIM provides industry-standard APIs, making it easy to build and integrate AI applications like chatbots, AI assistants, and more.</li>
</ul>
<p>NIM is part of NVIDIA AI Enterprise, which aims to simplify the deployment and operationalization of AI models, ensuring they run efficiently on NVIDIA GPUs.</p>
<ul>
<li>Demo: Using Nividia NIM to call Phi-3.5-Vision-API  [<a href="./python/Phi-3-Vision-Nividia-NIM.ipynb?WT.mc_id=academic-105485-koreyst">Click this link</a>]</li>
</ul>
<h4 id="inference-phi-335-in-local-env">Inference Phi-3/3.5 in local env<a class="headerlink" href="#inference-phi-335-in-local-env" title="Permanent link">¶</a></h4>
<p>Inference in relation to Phi-3, or any language model like GPT-3, refers to the process of generating responses or predictions based on the input it receives. When you provide a prompt or question to Phi-3, it uses its trained neural network to infer the most likely and relevant response by analyzing patterns and relationships in the data it was trained on.</p>
<p><strong>Hugging face Transformer</strong>
Hugging Face Transformers is a powerful library designed for natural language processing (NLP) and other machine learning tasks. Here are some key points about it:</p>
<ol>
<li>
<p><strong>Pretrained Models</strong>: It provides thousands of pretrained models that can be used for various tasks such as text classification, named entity recognition, question answering, summarization, translation, and text generation.</p>
</li>
<li>
<p><strong>Framework Interoperability</strong>: The library supports multiple deep learning frameworks, including PyTorch, TensorFlow, and JAX. This allows you to train a model in one framework and use it in another.</p>
</li>
<li>
<p><strong>Multimodal Capabilities</strong>: Besides NLP, Hugging Face Transformers also supports tasks in computer vision (e.g., image classification, object detection) and audio processing (e.g., speech recognition, audio classification).</p>
</li>
<li>
<p><strong>Ease of Use</strong>: The library offers APIs and tools to easily download and fine-tune models, making it accessible for both beginners and experts.</p>
</li>
<li>
<p><strong>Community and Resources</strong>: Hugging Face has a vibrant community and extensive documentation, tutorials, and guides to help users get started and make the most of the library.
<a href="https://huggingface.co/docs/transformers/index?WT.mc_id=academic-105485-koreyst">official documentation</a> or their <a href="https://github.com/huggingface/transformers?WT.mc_id=academic-105485-koreyst">GitHub repository</a>.</p>
</li>
</ol>
<p>This is the most commonly used method, but it also requires GPU acceleration. After all, scenes such as Vision and MoE require a lot of calculations, which will be very limited in the CPU if they are not quantized.</p>
<ul>
<li>
<p>Demo:Using Transformer to call Phi-3.5-Instuct <a href="./python/phi35-instruct-demo.ipynb?WT.mc_id=academic-105485-koreyst">Click this link</a></p>
</li>
<li>
<p>Demo:Using Transformer to call Phi-3.5-Vision<a href="./python/phi35-vision-demo.ipynb?WT.mc_id=academic-105485-koreyst">Click this link</a></p>
</li>
<li>
<p>Demo:Using Transformer to call Phi-3.5-MoE<a href="./python/phi35_moe_demo.ipynb?WT.mc_id=academic-105485-koreyst">Click this link</a></p>
</li>
</ul>
<p><strong>Ollama</strong>
<a href="https://ollama.com/?WT.mc_id=academic-105485-koreyst">Ollama</a> is a platform designed to make it easier to run large language models (LLMs) locally on your machine. It supports various models like Llama 3.1, Phi 3, Mistral, and Gemma 2, among others. The platform simplifies the process by bundling model weights, configuration, and data into a single package, making it more accessible for users to customize and create their own models. Ollama is available for macOS, Linux, and Windows. It’s a great tool if you’re looking to experiment with or deploy LLMs without relying on cloud services. Ollama is the most direct way, you just need to execute the following statement.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a>ollama<span class="w"> </span>run<span class="w"> </span>phi3.5
</span></code></pre></div>
<p><strong>ONNX Runtime for GenAI</strong></p>
<p><a href="https://github.com/microsoft/onnxruntime-genai?WT.mc_id=academic-105485-koreyst">ONNX Runtime</a> is a cross-platform inference and training machine-learning accelerator. ONNX Runtime for Generative AI (GENAI) is a powerful tool that helps you run generative AI models efficiently across various platforms. </p>
<h3 id="what-is-onnx-runtime">What is ONNX Runtime?<a class="headerlink" href="#what-is-onnx-runtime" title="Permanent link">¶</a></h3>
<p>ONNX Runtime is an open-source project that enables high-performance inference of machine learning models. It supports models in the Open Neural Network Exchange (ONNX) format, which is a standard for representing machine learning models.ONNX Runtime inference can enable faster customer experiences and lower costs, supporting models from deep learning frameworks such as PyTorch and TensorFlow/Keras as well as classical machine learning libraries such as scikit-learn, LightGBM, XGBoost, etc. ONNX Runtime is compatible with different hardware, drivers, and operating systems, and provides optimal performance by leveraging hardware accelerators where applicable alongside graph optimizations and transforms</p>
<h3 id="what-is-generative-ai">What is Generative AI?<a class="headerlink" href="#what-is-generative-ai" title="Permanent link">¶</a></h3>
<p>Generative AI refers to AI systems that can generate new content, such as text, images, or music, based on the data they have been trained on. Examples include language models like GPT-3 and image generation models like Stable Diffusion. ONNX Runtime for GenAI library provides the generative AI loop for ONNX models, including inference with ONNX Runtime, logits processing, search and sampling, and KV cache management.</p>
<h3 id="onnx-runtime-for-genai">ONNX Runtime for GENAI<a class="headerlink" href="#onnx-runtime-for-genai" title="Permanent link">¶</a></h3>
<p>ONNX Runtime for GENAI extends the capabilities of ONNX Runtime to support generative AI models. Here are some key features:</p>
<ul>
<li><strong>Broad Platform Support:</strong> It works on various platforms, including Windows, Linux, macOS, Android, and iOS.</li>
<li><strong>Model Support:</strong> It supports many popular generative AI models, such as LLaMA, GPT-Neo, BLOOM, and more.</li>
<li><strong>Performance Optimization:</strong> It includes optimizations for different hardware accelerators like NVIDIA GPUs, AMD GPUs, and more2.</li>
<li><strong>Ease of Use:</strong> It provides APIs for easy integration into applications, allowing you to generate text, images, and other content with minimal code</li>
<li>Users can call a high level generate() method, or run each iteration of the model in a loop, generating one token at a time, and optionally updating generation parameters inside the loop.</li>
<li>ONNX runtume also has support for greedy/beam search and TopP, TopK sampling to generate token sequences and built-in logits processing like repetition penalties. You can also easily add custom scoring.</li>
</ul>
<h3 id="getting-started">Getting Started<a class="headerlink" href="#getting-started" title="Permanent link">¶</a></h3>
<p>To get started with ONNX Runtime for GENAI, you can follow these steps:</p>
<h4 id="install-onnx-runtime">Install ONNX Runtime:<a class="headerlink" href="#install-onnx-runtime" title="Permanent link">¶</a></h4>
<div class="language-Python highlight"><pre><span></span><code><span id="__span-1-1"><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="n">pip</span> <span class="n">install</span> <span class="n">onnxruntime</span>
</span></code></pre></div>
<h4 id="install-the-generative-ai-extensions">Install the Generative AI Extensions:<a class="headerlink" href="#install-the-generative-ai-extensions" title="Permanent link">¶</a></h4>
<div class="language-Python highlight"><pre><span></span><code><span id="__span-2-1"><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="n">pip</span> <span class="n">install</span> <span class="n">onnxruntime</span><span class="o">-</span><span class="n">genai</span>
</span></code></pre></div>
<h4 id="run-a-model-heres-a-simple-example-in-python">Run a Model: Here’s a simple example in Python:<a class="headerlink" href="#run-a-model-heres-a-simple-example-in-python" title="Permanent link">¶</a></h4>
<div class="language-Python highlight"><pre><span></span><code><span id="__span-3-1"><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="kn">import</span> <span class="nn">onnxruntime_genai</span> <span class="k">as</span> <span class="nn">og</span>
</span><span id="__span-3-2"><a href="#__codelineno-3-2" id="__codelineno-3-2" name="__codelineno-3-2"></a>
</span><span id="__span-3-3"><a href="#__codelineno-3-3" id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="n">model</span> <span class="o">=</span> <span class="n">og</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s1">'path_to_your_model.onnx'</span><span class="p">)</span>
</span><span id="__span-3-4"><a href="#__codelineno-3-4" id="__codelineno-3-4" name="__codelineno-3-4"></a>
</span><span id="__span-3-5"><a href="#__codelineno-3-5" id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="n">tokenizer</span> <span class="o">=</span> <span class="n">og</span><span class="o">.</span><span class="n">Tokenizer</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="__span-3-6"><a href="#__codelineno-3-6" id="__codelineno-3-6" name="__codelineno-3-6"></a>
</span><span id="__span-3-7"><a href="#__codelineno-3-7" id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="n">input_text</span> <span class="o">=</span> <span class="s2">"Hello, how are you?"</span>
</span><span id="__span-3-8"><a href="#__codelineno-3-8" id="__codelineno-3-8" name="__codelineno-3-8"></a>
</span><span id="__span-3-9"><a href="#__codelineno-3-9" id="__codelineno-3-9" name="__codelineno-3-9"></a><span class="n">input_tokens</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">input_text</span><span class="p">)</span>
</span><span id="__span-3-10"><a href="#__codelineno-3-10" id="__codelineno-3-10" name="__codelineno-3-10"></a>
</span><span id="__span-3-11"><a href="#__codelineno-3-11" id="__codelineno-3-11" name="__codelineno-3-11"></a><span class="n">output_tokens</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">input_tokens</span><span class="p">)</span>
</span><span id="__span-3-12"><a href="#__codelineno-3-12" id="__codelineno-3-12" name="__codelineno-3-12"></a>
</span><span id="__span-3-13"><a href="#__codelineno-3-13" id="__codelineno-3-13" name="__codelineno-3-13"></a><span class="n">output_text</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">output_tokens</span><span class="p">)</span>
</span><span id="__span-3-14"><a href="#__codelineno-3-14" id="__codelineno-3-14" name="__codelineno-3-14"></a>
</span><span id="__span-3-15"><a href="#__codelineno-3-15" id="__codelineno-3-15" name="__codelineno-3-15"></a><span class="nb">print</span><span class="p">(</span><span class="n">output_text</span><span class="p">)</span> 
</span></code></pre></div>
<h4 id="demousing-onnx-runtime-genai-to-call-phi-35-vision">Demo:Using ONNX Runtime GenAI to call Phi-3.5-Vision<a class="headerlink" href="#demousing-onnx-runtime-genai-to-call-phi-35-vision" title="Permanent link">¶</a></h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="kn">import</span> <span class="nn">onnxruntime_genai</span> <span class="k">as</span> <span class="nn">og</span>
</span><span id="__span-4-2"><a href="#__codelineno-4-2" id="__codelineno-4-2" name="__codelineno-4-2"></a>
</span><span id="__span-4-3"><a href="#__codelineno-4-3" id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="n">model_path</span> <span class="o">=</span> <span class="s1">'./Your Phi-3.5-vision-instruct ONNX Path'</span>
</span><span id="__span-4-4"><a href="#__codelineno-4-4" id="__codelineno-4-4" name="__codelineno-4-4"></a>
</span><span id="__span-4-5"><a href="#__codelineno-4-5" id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="n">img_path</span> <span class="o">=</span> <span class="s1">'./Your Image Path'</span>
</span><span id="__span-4-6"><a href="#__codelineno-4-6" id="__codelineno-4-6" name="__codelineno-4-6"></a>
</span><span id="__span-4-7"><a href="#__codelineno-4-7" id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="n">model</span> <span class="o">=</span> <span class="n">og</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">model_path</span><span class="p">)</span>
</span><span id="__span-4-8"><a href="#__codelineno-4-8" id="__codelineno-4-8" name="__codelineno-4-8"></a>
</span><span id="__span-4-9"><a href="#__codelineno-4-9" id="__codelineno-4-9" name="__codelineno-4-9"></a><span class="n">processor</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">create_multimodal_processor</span><span class="p">()</span>
</span><span id="__span-4-10"><a href="#__codelineno-4-10" id="__codelineno-4-10" name="__codelineno-4-10"></a>
</span><span id="__span-4-11"><a href="#__codelineno-4-11" id="__codelineno-4-11" name="__codelineno-4-11"></a><span class="n">tokenizer_stream</span> <span class="o">=</span> <span class="n">processor</span><span class="o">.</span><span class="n">create_stream</span><span class="p">()</span>
</span><span id="__span-4-12"><a href="#__codelineno-4-12" id="__codelineno-4-12" name="__codelineno-4-12"></a>
</span><span id="__span-4-13"><a href="#__codelineno-4-13" id="__codelineno-4-13" name="__codelineno-4-13"></a><span class="n">text</span> <span class="o">=</span> <span class="s2">"Your Prompt"</span>
</span><span id="__span-4-14"><a href="#__codelineno-4-14" id="__codelineno-4-14" name="__codelineno-4-14"></a>
</span><span id="__span-4-15"><a href="#__codelineno-4-15" id="__codelineno-4-15" name="__codelineno-4-15"></a><span class="n">prompt</span> <span class="o">=</span> <span class="s2">"&lt;|user|&gt;</span><span class="se">\n</span><span class="s2">"</span>
</span><span id="__span-4-16"><a href="#__codelineno-4-16" id="__codelineno-4-16" name="__codelineno-4-16"></a>
</span><span id="__span-4-17"><a href="#__codelineno-4-17" id="__codelineno-4-17" name="__codelineno-4-17"></a><span class="n">prompt</span> <span class="o">+=</span> <span class="s2">"&lt;|image_1|&gt;</span><span class="se">\n</span><span class="s2">"</span>
</span><span id="__span-4-18"><a href="#__codelineno-4-18" id="__codelineno-4-18" name="__codelineno-4-18"></a>
</span><span id="__span-4-19"><a href="#__codelineno-4-19" id="__codelineno-4-19" name="__codelineno-4-19"></a><span class="n">prompt</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">&lt;|end|&gt;</span><span class="se">\n</span><span class="s2">"</span>
</span><span id="__span-4-20"><a href="#__codelineno-4-20" id="__codelineno-4-20" name="__codelineno-4-20"></a>
</span><span id="__span-4-21"><a href="#__codelineno-4-21" id="__codelineno-4-21" name="__codelineno-4-21"></a><span class="n">prompt</span> <span class="o">+=</span> <span class="s2">"&lt;|assistant|&gt;</span><span class="se">\n</span><span class="s2">"</span>
</span><span id="__span-4-22"><a href="#__codelineno-4-22" id="__codelineno-4-22" name="__codelineno-4-22"></a>
</span><span id="__span-4-23"><a href="#__codelineno-4-23" id="__codelineno-4-23" name="__codelineno-4-23"></a><span class="n">image</span> <span class="o">=</span> <span class="n">og</span><span class="o">.</span><span class="n">Images</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">img_path</span><span class="p">)</span>
</span><span id="__span-4-24"><a href="#__codelineno-4-24" id="__codelineno-4-24" name="__codelineno-4-24"></a>
</span><span id="__span-4-25"><a href="#__codelineno-4-25" id="__codelineno-4-25" name="__codelineno-4-25"></a><span class="n">inputs</span> <span class="o">=</span> <span class="n">processor</span><span class="p">(</span><span class="n">prompt</span><span class="p">,</span> <span class="n">images</span><span class="o">=</span><span class="n">image</span><span class="p">)</span>
</span><span id="__span-4-26"><a href="#__codelineno-4-26" id="__codelineno-4-26" name="__codelineno-4-26"></a>
</span><span id="__span-4-27"><a href="#__codelineno-4-27" id="__codelineno-4-27" name="__codelineno-4-27"></a><span class="n">params</span> <span class="o">=</span> <span class="n">og</span><span class="o">.</span><span class="n">GeneratorParams</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="__span-4-28"><a href="#__codelineno-4-28" id="__codelineno-4-28" name="__codelineno-4-28"></a>
</span><span id="__span-4-29"><a href="#__codelineno-4-29" id="__codelineno-4-29" name="__codelineno-4-29"></a><span class="n">params</span><span class="o">.</span><span class="n">set_inputs</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</span><span id="__span-4-30"><a href="#__codelineno-4-30" id="__codelineno-4-30" name="__codelineno-4-30"></a>
</span><span id="__span-4-31"><a href="#__codelineno-4-31" id="__codelineno-4-31" name="__codelineno-4-31"></a><span class="n">params</span><span class="o">.</span><span class="n">set_search_options</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">3072</span><span class="p">)</span>
</span><span id="__span-4-32"><a href="#__codelineno-4-32" id="__codelineno-4-32" name="__codelineno-4-32"></a>
</span><span id="__span-4-33"><a href="#__codelineno-4-33" id="__codelineno-4-33" name="__codelineno-4-33"></a><span class="n">generator</span> <span class="o">=</span> <span class="n">og</span><span class="o">.</span><span class="n">Generator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
</span><span id="__span-4-34"><a href="#__codelineno-4-34" id="__codelineno-4-34" name="__codelineno-4-34"></a>
</span><span id="__span-4-35"><a href="#__codelineno-4-35" id="__codelineno-4-35" name="__codelineno-4-35"></a><span class="k">while</span> <span class="ow">not</span> <span class="n">generator</span><span class="o">.</span><span class="n">is_done</span><span class="p">():</span>
</span><span id="__span-4-36"><a href="#__codelineno-4-36" id="__codelineno-4-36" name="__codelineno-4-36"></a>
</span><span id="__span-4-37"><a href="#__codelineno-4-37" id="__codelineno-4-37" name="__codelineno-4-37"></a>    <span class="n">generator</span><span class="o">.</span><span class="n">compute_logits</span><span class="p">()</span>
</span><span id="__span-4-38"><a href="#__codelineno-4-38" id="__codelineno-4-38" name="__codelineno-4-38"></a>
</span><span id="__span-4-39"><a href="#__codelineno-4-39" id="__codelineno-4-39" name="__codelineno-4-39"></a>    <span class="n">generator</span><span class="o">.</span><span class="n">generate_next_token</span><span class="p">()</span>
</span><span id="__span-4-40"><a href="#__codelineno-4-40" id="__codelineno-4-40" name="__codelineno-4-40"></a>
</span><span id="__span-4-41"><a href="#__codelineno-4-41" id="__codelineno-4-41" name="__codelineno-4-41"></a>    <span class="n">new_token</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">get_next_tokens</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-4-42"><a href="#__codelineno-4-42" id="__codelineno-4-42" name="__codelineno-4-42"></a>
</span><span id="__span-4-43"><a href="#__codelineno-4-43" id="__codelineno-4-43" name="__codelineno-4-43"></a>    <span class="n">code</span> <span class="o">+=</span> <span class="n">tokenizer_stream</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">new_token</span><span class="p">)</span>
</span><span id="__span-4-44"><a href="#__codelineno-4-44" id="__codelineno-4-44" name="__codelineno-4-44"></a>
</span><span id="__span-4-45"><a href="#__codelineno-4-45" id="__codelineno-4-45" name="__codelineno-4-45"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">tokenizer_stream</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">new_token</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">''</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></code></pre></div>
<p><strong>Others</strong></p>
<p>In addition to ONNX Runtime and Ollama reference methods, we can also complete the reference of quantitative models based on the model reference methods provided by different manufacturers. Such as Apple MLX framework with Apple Metal, Qualcomm QNN with NPU, Intel OpenVINO with CPU/GPU, etc. You can also get more content from <a href="https://github.com/microsoft/phi-3cookbook?WT.mc_id=academic-105485-koreyst">Phi-3 Cookbook</a></p>
<h3 id="more">More<a class="headerlink" href="#more" title="Permanent link">¶</a></h3>
<p>We have learned the basics of Phi-3/3.5 Family, but to learn more about SLM we need more knowledge. You can find the answers in the Phi-3 Cookbook. If you want to learn more, please visit the <a href="https://github.com/microsoft/phi-3cookbook?WT.mc_id=academic-105485-koreyst">Phi-3 Cookbook</a>.</p></div>
<aside class="md-source-file">
<span class="md-source-file__fact">
<span class="md-icon" title="Last update">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg>
</span>
<span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime">February 19, 2025 15:07:13</span>
</span>
</aside>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Back to top
</button>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: Lesson 18" class="md-footer__link md-footer__link--prev" href="../18-fine-tuning/">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</div>
<div class="md-footer__title">
<span class="md-footer__direction">
                Previous
              </span>
<div class="md-ellipsis">
                Lesson 18
              </div>
</div>
</a>
<a aria-label="Next: Lesson 20" class="md-footer__link md-footer__link--next" href="../20-mistral/">
<div class="md-footer__title">
<span class="md-footer__direction">
                Next
              </span>
<div class="md-ellipsis">
                Lesson 20
              </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
<div class="md-social">
<a class="md-social__link" href="https://github.com/gitmichaelqiu" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.path", "navigation.top", "navigation.footer", "content.code.copy", "content.code.select", "content.code.annotate"], "search": "../../../assets/javascripts/workers/search.07f07601.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../../assets/javascripts/bundle.56dfad97.min.js"></script>
<script src="../../../javascripts/mathjax.js"></script>
<script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>